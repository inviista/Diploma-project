{% load calendar_widget %}
{% load static %}

<div class="flex flex-col w-full h-auto shadow-[0px_4px_4px_0px_#0000001A] bg-white mt-3 p-4 rounded-[16px]">
    <div class="flex flex-col w-full border-b-3 border-[#EFEFEF] pb-3">
        <div class="flex justify-between">
            <text class="font-bold text-2xl">Календарь событий</text>

            <a href="{% url 'news:event_calendar' %}" class="w-[36px] h-fit">
                <img src="{% static 'img/_src/icons/Frame 58 (6).png' %}">
            </a>
        </div>
        <text class="font-medium max-lg:text-sm">Следи за важными датами в сфере охраны <br> труда: форумы, проверки,
                дедлайны <br> и ключевые мероприятия
        </text>
    </div>
    <div class="p-1 pt-3">
        {% render_calendar calendar_year calendar_month events_by_day %}

        {% include 'includes/main/calendar_events.html' %}
    </div>
</div>

<script>
    function getEventsByDate(date) {
         fetch(`{% url 'news:get_events_by_date' %}?date=${date}`)
        .then((res) => res.text())
        .then((html) => {
            console.log(document.getElementById("calendarEvents"));
            document.getElementById("calendarEvents").innerHTML = html;
        })
        .catch((err) => {
          console.error("Failed to fetch events:", err);
        });
    }

    document.addEventListener('DOMContentLoaded', function () {
        getEventsByDate(new Date())
    });
</script>